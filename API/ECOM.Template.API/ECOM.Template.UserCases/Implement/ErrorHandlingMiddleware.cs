using Microsoft.Extensions.Configuration;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Net;
using System.Text;
using System.Text.Json;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Logging;

using MassTransit.Clients;
using ECOM.Template.Models.Exeptions;
using ECOM.Utils.Nuget.Logic.Interfaces;

namespace ECOM.Template.UserCases.Implement
{
    public class ErrorHandlingMiddleware
    {
        private readonly RequestDelegate _next;
        private readonly IHostEnvironment _env;
        private readonly IEmailService _emailService;
        private readonly IConfiguration _configuration;
        private readonly bool _isTask;

        public ErrorHandlingMiddleware(RequestDelegate next, IHostEnvironment env, ILogger<ErrorHandlingMiddleware> logger, IEmailService emailService, IConfiguration configuration)
        {
            _next = next;
            _env = env;
            _emailService = emailService;
            _configuration = configuration;
            _isTask = env == null;
        }

        public async Task Invoke(HttpContext context)
        {
            try
            {
                await _next(context);
            }
            catch (Exception ex)
            {
                await HandleExceptionAsync(context, ex);
            }
        }

        public Task HandleExceptionAsync(HttpContext context, Exception exception)
        {
            context.Response.ContentType = "application/json";
            context.Response.StatusCode = (int)HttpStatusCode.InternalServerError;
            return context.Response.WriteAsync(JsonSerializer.Serialize(HandlerException(exception)));
        }

        public MessageResponse<object> HandlerException(Exception exception)
        {
            var typeException = exception.GetType();
            var messages = GetMessages(exception);
            var titleEmail = string.Empty;
            var bodyEmail = string.Empty;
            var friendlyMessage = string.Empty;
            if (typeException == typeof(WebServiceException))
            {
                var webServiceException = exception as WebServiceException;
                titleEmail = $"Fallo al consumir un servicio interno de tipo {webServiceException.TypeWebService}";
                bodyEmail = webServiceException.TypeWebService == "REST" ?
                    this.BuildTemplateREST(webServiceException, _configuration["ApiName"], messages) :
                    this.BuildTemplateWCF(webServiceException, _configuration["ApiName"], messages);
                friendlyMessage = webServiceException.FriendlyMessage;
            }
            else if (typeException == typeof(RepositoryFileException))
            {
                var repositoryFileException = exception as RepositoryFileException;
                titleEmail = $"Fallo al consumir  {repositoryFileException.TypeException}";
                bodyEmail = this.BuildTemplateRepositoryFile(repositoryFileException, messages);
            }
            else if (typeException == typeof(FtpExeption))
            {
                var repositoryFtpException = exception as FtpExeption;
                titleEmail = $"Fallo al consumir  {repositoryFtpException.TypeFtpExcepcion}";
                bodyEmail = this.BuildTemplateFtp(repositoryFtpException, messages);
            }
            else if (false) // others ... 
            { }
            else
            {
                titleEmail = $"Ocurrió un error";
                bodyEmail = this.BuildTemplateGeneral(exception, _configuration["ApiName"], messages);
            }

            this.SendNotificationError($"{_configuration["Environment"]} | {titleEmail}", bodyEmail);

            return new MessageResponse<object>(new Error
            {
                Message = !string.IsNullOrEmpty(friendlyMessage) ?
                friendlyMessage : $"Ocurrió un error inesperado {(!_isTask && _env.IsDevelopment() ? messages.FirstOrDefault()?.Item1 : string.Empty)}",
                MessageDetail = $"{(!_isTask && _env.IsDevelopment() ? string.Join(Environment.NewLine, messages.Select(X => $"{X.Item1} \n {X.Item2}")) : string.Empty)}"
            });
        }

        public List<Tuple<string, string>> GetMessages(Exception exception)
        {
            if (exception == null)
                return null;

            var currentException = exception;
            var counter = 0;
            var messages = new List<Tuple<string, string>>();
            do
            {
                messages.Add(new Tuple<string, string>(currentException.Message, currentException.StackTrace));
                currentException = currentException.InnerException;
                counter++;
            }
            while (currentException != null);

            return messages;
        }

        public void SendNotificationError(string title, string body)
        {
            try
            {
                var message = new System.Net.Mail.MailMessage(_configuration["Smtp:Email"], _configuration["Constants:EmailsToSendErrors"], title, string.Empty);
                message.Body = body;
                message.IsBodyHtml = true;
                _emailService.SendMessage(message);
            }
            catch (Exception ex)
            {
            }
        }

        public string BuildTemplateREST(WebServiceException exception, string api, List<Tuple<string, string>> messages)
        {
            var template = TemplateRestException.Replace("{API}", api);
            template = template.Replace("{TITLE}", $"Fallo al consumir un servicio interno de tipo {exception.TypeWebService}");
            template = template.Replace("{URL}", exception.Url);
            template = template.Replace("{HEADERS}", exception.Headers);
            template = template.Replace("{REQUEST}", exception.Request);
            template = template.Replace("{RESPONSE}", exception.Response);
            template = template.Replace("{STATUSCODE}", exception.StatusCode);
            template = template.Replace("{METHOD}", exception.Method);
            return template.Replace("{EXCEPTIONS}", this.BuildExceptions(messages));
        }

        public string BuildTemplateWCF(WebServiceException exception, string api, List<Tuple<string, string>> messages)
        {
            var template = TemplateWCF.Replace("{API}", api);
            template = template.Replace("{TITLE}", $"Fallo al consumir un servicio interno de tipo {exception.TypeWebService}");
            template = template.Replace("{ENDPOINT}", exception.EndPoint);
            template = template.Replace("{PARAMETERS}", exception.Parameters);
            return template.Replace("{EXCEPTIONS}", this.BuildExceptions(messages));
        }

        public string BuildTemplateRepositoryFile(RepositoryFileException exception, List<Tuple<string, string>> messages)
        {
            var template = TemplateRepositoryFile.Replace("{TYPEREPOSITORY}", $"{exception.TypeException}");

            template = template.Replace("{TITLE}", $"Fallo al realizar la accion {exception.Action} " +
                $"en un repositorio de tipo {exception.TypeException}");

            template = template.Replace("{BASEPATH}", !string.IsNullOrEmpty(exception.BasePath) ?
                exception.BasePath : "No continene path");


            template = template.Replace("{CONNECTION}", !string.IsNullOrEmpty(exception.Connection) ? exception.Connection : "No contiene connection");

            template = template.Replace("{OBJECTREQUEST}", exception.ObjectRequest);
            return template.Replace("{EXCEPTIONS}", this.BuildExceptions(messages));
        }

        public string BuildTemplateFtp(FtpExeption exception, List<Tuple<string, string>> messages)
        {
            var template = TemplateFtp.Replace("{TITLE}", $"Fallo al realizar la accion {exception.Action} " +
                $"en un repositorio tipo {exception.TypeFtpExcepcion}");
            template = template.Replace("{DIRECTORYNAME}", exception.DirectoryName);
            template = template.Replace("{FILENAME}", exception.FileName);
            template = template.Replace("{USER}", exception.User);
            template = template.Replace("{PASSWORD}", exception.Password);
            template = template.Replace("{HOST}", exception.Host);
            template = template.Replace("{PORT}", exception.Port);
            template = template.Replace("{ACTION}", exception.Action);
            return template.Replace("{EXCEPTIONS}", this.BuildExceptions(messages));
        }

        public string BuildTemplateGeneral(Exception exception, string api, List<Tuple<string, string>> messages)
        {
            var template = TemplateGeneral.Replace("{API}", api);
            template = template.Replace("{TITLE}", $"Ocurrió un error inesperado {(!_isTask && _env.IsDevelopment() ? messages.FirstOrDefault()?.Item1 : string.Empty)}");
            return template.Replace("{EXCEPTIONS}", this.BuildExceptions(messages));
        }

        public string BuildExceptions(List<Tuple<string, string>> messages)
        {
            var builderExceptions = new StringBuilder();
            foreach (var message in messages)
            {
                var templateExceptions = TemplateExceptions.Replace("{MESSAGE}", message.Item1);
                templateExceptions = templateExceptions.Replace("{DETAIL}", message.Item2);
                builderExceptions.AppendLine(templateExceptions);
            }

            return builderExceptions.ToString();
        }

        public string TemplateWCF { get; set; } = "    <div class=\"m_-3594805284658035001container\" style=\"font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;color:#212121;font-size:14px;background:#f8f8f8\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n            <tbody><tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background-color:white;border-bottom:solid #eaeaea 1px\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n                        \r\n                        \r\n        <tbody><tr>\r\n            <td style=\"padding:20px 24px 25px 24px;background:white\">\r\n                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                    <tbody><tr>\r\n                        <td>\r\n                            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"m_-3594805284658035001logo\" width=\"100%\">\r\n                                <tbody><tr>\r\n                                    <td valign=\"middle\" style=\"vertical-align:middle\">\r\n                                        <!-- <img alt=\"Microsoft\" height=\"16\" src=\"https://ci5.googleusercontent.com/proxy/n5DO0ehZnx5Fu70IFup8danV4RPNKJRGGp6_zn__LMrXJyzwXwgq0OOl0IEtMtMPymeH-xAZ70DFXsZwTGpZGetuUghalnbFjvL5EBeJVaMw=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/v3/microsoft.png\" width=\"80\" class=\"CToWUd\"> -->\r\n                                    </td>\r\n                                        <td valign=\"middle\" style=\"word-wrap:none;vertical-align:middle;text-align:right\">\r\n                                            <span style=\"color:#666666\"><span class=\"il\">BackOffice</span></span> <span style=\"color:#0078d4;font-weight:bold\">Api\u00B4s</span>\r\n                                        </td>\r\n                                </tr>\r\n                            </tbody></table>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n            </td>\r\n        </tr>\r\n        \r\n                        \r\n                        \r\n        \r\n        \r\n        \r\n        \r\n        <tr>\r\n        <td style=\"padding:0px 24px\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"max-width:592px\" class=\"m_-3594805284658035001responsive-table\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                  <td>\r\n                    <table>\r\n                      <tbody><tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                          \r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle\">\r\n                <tbody><tr>\r\n                        \r\n                        <td style=\"padding-right:7px\" valign=\"top\"><img src=\"https://ci5.googleusercontent.com/proxy/bYYIEH2lZh5Gpyv0a9-8WPkjQIvjxGeoRvKmGLQgRvxd6MyqBgDAheB5yzVHqY8EZzgw8L0vQhEgb1HpLANCpbSF7VcTxjqkJyBEsQNZCXW62K1w=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/icon-failure-20.png\" width=\"20\" height=\"20\" class=\"m_-3594805284658035001img-block CToWUd\"></td>\r\n                        <td valign=\"middle\" style=\"font-size:13px;font-weight:400;line-height:20px;color:#ff4743;font-family:Segoe UI,Helvetica,Arial,sans-serif;padding-top:0px;vertical-align:middle;text-transform:uppercase\">{API}</td>\r\n                \r\n                </tr>\r\n            </tbody></table>\r\n        \r\n                        </td>\r\n                      </tr>\r\n        \r\n                        \r\n                          <tr>\r\n                            <td class=\"m_-3594805284658035001title\" style=\"padding:0 0 24px 0;color:#212121;font-size:28px;font-weight:bold;letter-spacing:-0.04em;line-height:40px;word-break:break-word\">\r\n                             {TITLE}\r\n                            </td>\r\n                          </tr>\r\n                      \r\n        \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            <!-- <pre style=\"white-space:pre-wrap;display:inline;font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;padding:0px;margin:0px;font-size:14px;line-height:20px;color:#444444;word-break:break-word\">Ran for 25 seconds</pre> -->\r\n                       </td>\r\n                      </tr>\r\n                      \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            \r\n        \r\n        \r\n<!--         \r\n        <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                      \r\n                      <td align=\"center\" bgcolor=\"#007acc\" style=\"padding:8px 12px;border-radius:2px\">\r\n                        <a href=\"https://dev.azure.com/BroxelDev/web/build.aspx?pcguid=87cecc23-6053-4e3b-9823-cb915131eec4&amp;builduri=vstfs%3a%2f%2f%2fBuild%2fBuild%2f36516&amp;tracking_data=eyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%3d\" style=\"font-weight:500;font-size:14px;text-decoration:none;padding:0px;display:inline-block;color:#ffffff\" class=\"m_-3594805284658035001mobile-button m_-3594805284658035001btn-primary\" target=\"_blank\" data-saferedirecturl=\"https://www.google.com/url?q=https://dev.azure.com/BroxelDev/web/build.aspx?pcguid%3D87cecc23-6053-4e3b-9823-cb915131eec4%26builduri%3Dvstfs%253a%252f%252f%252fBuild%252fBuild%252f36516%26tracking_data%3DeyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%253d&amp;source=gmail&amp;ust=1601407055375000&amp;usg=AFQjCNFlAPKWnSTO1iFkjil1vsarMYhhsQ\">\r\n                          View results\r\n                        </a>\r\n                      </td>\r\n                      \r\n                      \r\n                    \r\n        \r\n        \r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table> -->\r\n        \r\n                        </td>\r\n                      </tr>\r\n                    </tbody></table>\r\n                  </td>\r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table>\r\n        \r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                </td>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background:#f8f8f8\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">            \r\n                        \r\n                            \r\n                            \r\n                                    <tbody><tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Summary\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width:100%;border-collapse:collapse!important\">\r\n        <tbody><tr>            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">EndPoint</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{ENDPOINT}</td>\r\n        </tr>        <tr>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Parameters</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{PARAMETERS}</td>\r\n        </tr>                \r\n</tbody></table>\r\n        \r\n                            </td>\r\n                        </tr>\r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Exceptions\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                {EXCEPTIONS}\r\n                            </td>\r\n                        </tr>\r\n\r\n                        \r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n        \r\n                        \r\n                        \r\n        \r\n        <tr>\r\n        <td style=\"padding:24px 24px 24px 24px\">\r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                </tr>\r\n                    <tr>\r\n                    </tr>\r\n                \r\n                    <tr>\r\n                    </tr>\r\n            </tbody></table>\r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                    \r\n                </td>   \r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n            </tr>\r\n         </tbody></table>\r\n        </div>";

        public string TemplateRestException { get; } = "   <div class=\"m_-3594805284658035001container\" style=\"font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;color:#212121;font-size:14px;background:#f8f8f8\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n            <tbody><tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background-color:white;border-bottom:solid #eaeaea 1px\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n                        \r\n                        \r\n        <tbody><tr>\r\n            <td style=\"padding:20px 24px 25px 24px;background:white\">\r\n                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                    <tbody><tr>\r\n                        <td>\r\n                            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"m_-3594805284658035001logo\" width=\"100%\">\r\n                                <tbody><tr>\r\n                                    <td valign=\"middle\" style=\"vertical-align:middle\">\r\n                                        <!-- <img alt=\"Microsoft\" height=\"16\" src=\"https://ci5.googleusercontent.com/proxy/n5DO0ehZnx5Fu70IFup8danV4RPNKJRGGp6_zn__LMrXJyzwXwgq0OOl0IEtMtMPymeH-xAZ70DFXsZwTGpZGetuUghalnbFjvL5EBeJVaMw=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/v3/microsoft.png\" width=\"80\" class=\"CToWUd\"> -->\r\n                                    </td>\r\n                                        <td valign=\"middle\" style=\"word-wrap:none;vertical-align:middle;text-align:right\">\r\n                                            <span style=\"color:#666666\"><span class=\"il\">BackOffice</span></span> <span style=\"color:#0078d4;font-weight:bold\">Api\u00B4s</span>\r\n                                        </td>\r\n                                </tr>\r\n                            </tbody></table>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n            </td>\r\n        </tr>\r\n        \r\n                        \r\n                        \r\n        \r\n        \r\n        \r\n        \r\n        <tr>\r\n        <td style=\"padding:0px 24px\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"max-width:592px\" class=\"m_-3594805284658035001responsive-table\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                  <td>\r\n                    <table>\r\n                      <tbody><tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                          \r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle\">\r\n                <tbody><tr>\r\n                        \r\n                        <td style=\"padding-right:7px\" valign=\"top\"><img src=\"https://ci5.googleusercontent.com/proxy/bYYIEH2lZh5Gpyv0a9-8WPkjQIvjxGeoRvKmGLQgRvxd6MyqBgDAheB5yzVHqY8EZzgw8L0vQhEgb1HpLANCpbSF7VcTxjqkJyBEsQNZCXW62K1w=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/icon-failure-20.png\" width=\"20\" height=\"20\" class=\"m_-3594805284658035001img-block CToWUd\"></td>\r\n                        <td valign=\"middle\" style=\"font-size:13px;font-weight:400;line-height:20px;color:#ff4743;font-family:Segoe UI,Helvetica,Arial,sans-serif;padding-top:0px;vertical-align:middle;text-transform:uppercase\">{API}</td>\r\n                \r\n                </tr>\r\n            </tbody></table>\r\n        \r\n                        </td>\r\n                      </tr>\r\n        \r\n                        \r\n                          <tr>\r\n                            <td class=\"m_-3594805284658035001title\" style=\"padding:0 0 24px 0;color:#212121;font-size:28px;font-weight:bold;letter-spacing:-0.04em;line-height:40px;word-break:break-word\">\r\n                             {TITLE}\r\n                            </td>\r\n                          </tr>\r\n                      \r\n        \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            <!-- <pre style=\"white-space:pre-wrap;display:inline;font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;padding:0px;margin:0px;font-size:14px;line-height:20px;color:#444444;word-break:break-word\">Ran for 25 seconds</pre> -->\r\n                       </td>\r\n                      </tr>\r\n                      \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            \r\n        \r\n        \r\n<!--         \r\n        <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                      \r\n                      <td align=\"center\" bgcolor=\"#007acc\" style=\"padding:8px 12px;border-radius:2px\">\r\n                        <a href=\"https://dev.azure.com/BroxelDev/web/build.aspx?pcguid=87cecc23-6053-4e3b-9823-cb915131eec4&amp;builduri=vstfs%3a%2f%2f%2fBuild%2fBuild%2f36516&amp;tracking_data=eyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%3d\" style=\"font-weight:500;font-size:14px;text-decoration:none;padding:0px;display:inline-block;color:#ffffff\" class=\"m_-3594805284658035001mobile-button m_-3594805284658035001btn-primary\" target=\"_blank\" data-saferedirecturl=\"https://www.google.com/url?q=https://dev.azure.com/BroxelDev/web/build.aspx?pcguid%3D87cecc23-6053-4e3b-9823-cb915131eec4%26builduri%3Dvstfs%253a%252f%252f%252fBuild%252fBuild%252f36516%26tracking_data%3DeyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%253d&amp;source=gmail&amp;ust=1601407055375000&amp;usg=AFQjCNFlAPKWnSTO1iFkjil1vsarMYhhsQ\">\r\n                          View results\r\n                        </a>\r\n                      </td>\r\n                      \r\n                      \r\n                    \r\n        \r\n        \r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table> -->\r\n        \r\n                        </td>\r\n                      </tr>\r\n                    </tbody></table>\r\n                  </td>\r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table>\r\n        \r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                </td>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background:#f8f8f8\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">            \r\n                        \r\n                            \r\n                            \r\n                                    <tbody><tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Summary\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width:100%;border-collapse:collapse!important\">\r\n        <tbody><tr>            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Url</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{URL}</td>\r\n        </tr>        <tr>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Headers</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{HEADERS}</td>\r\n        </tr>        \r\n        <tr>                <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Request</td>\r\n                        <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{REQUEST}</td>\r\n        </tr>        \r\n        <tr>            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Response</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{RESPONSE}</td>\r\n        </tr>    \r\n        <tr>            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">StatusCode</td>\r\n            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{STATUSCODE}</td>\r\n</tr>  \r\n<tr>            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:none;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Method</td>\r\n    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:none;text-align:left;white-space:normal;width:99%;word-break:break-word\">{METHOD}</td>\r\n</tr>  \r\n</tbody></table>\r\n        \r\n                            </td>\r\n                        </tr>\r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Exceptions\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                {EXCEPTIONS}\r\n                            </td>\r\n                        </tr>\r\n\r\n                        \r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n        \r\n                        \r\n                        \r\n        \r\n        <tr>\r\n        <td style=\"padding:24px 24px 24px 24px\">\r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                </tr>\r\n                    <tr>\r\n                    </tr>\r\n                \r\n                    <tr>\r\n                    </tr>\r\n            </tbody></table>\r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                    \r\n                </td>   \r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n            </tr>\r\n         </tbody></table>\r\n        </div>";
        public string TemplateExceptions { get; } = "                                    <table>\r\n            <tbody><tr>\r\n                <td>{MESSAGE}</td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <table style=\"padding-left:2em\">\r\n                        <tbody><tr>\r\n                            <td style=\"word-break: break-word;\" colspan=\"2\">{DETAIL}</td>\r\n                        </tr>\r\n                    </tbody></table>\r\n                </td>\r\n            </tr>\r\n        </tbody></table>";

        public string TemplateGeneral { get; } = "    <div class=\"m_-3594805284658035001container\" style=\"font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;color:#212121;font-size:14px;background:#f8f8f8\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n            <tbody><tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background-color:white;border-bottom:solid #eaeaea 1px\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n                        \r\n                        \r\n        <tbody><tr>\r\n            <td style=\"padding:20px 24px 25px 24px;background:white\">\r\n                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                    <tbody><tr>\r\n                        <td>\r\n                            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"m_-3594805284658035001logo\" width=\"100%\">\r\n                                <tbody><tr>\r\n                                    <td valign=\"middle\" style=\"vertical-align:middle\">\r\n                                        <!-- <img alt=\"Microsoft\" height=\"16\" src=\"https://ci5.googleusercontent.com/proxy/n5DO0ehZnx5Fu70IFup8danV4RPNKJRGGp6_zn__LMrXJyzwXwgq0OOl0IEtMtMPymeH-xAZ70DFXsZwTGpZGetuUghalnbFjvL5EBeJVaMw=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/v3/microsoft.png\" width=\"80\" class=\"CToWUd\"> -->\r\n                                    </td>\r\n                                        <td valign=\"middle\" style=\"word-wrap:none;vertical-align:middle;text-align:right\">\r\n                                            <span style=\"color:#666666\"><span class=\"il\">BackOffice</span></span> <span style=\"color:#0078d4;font-weight:bold\">Api\u00B4s</span>\r\n                                        </td>\r\n                                </tr>\r\n                            </tbody></table>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n            </td>\r\n        </tr>\r\n        \r\n                        \r\n                        \r\n        \r\n        \r\n        \r\n        \r\n        <tr>\r\n        <td style=\"padding:0px 24px\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"max-width:592px\" class=\"m_-3594805284658035001responsive-table\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                  <td>\r\n                    <table>\r\n                      <tbody><tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                          \r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle\">\r\n                <tbody><tr>\r\n                        \r\n                        <td style=\"padding-right:7px\" valign=\"top\"><img src=\"https://ci5.googleusercontent.com/proxy/bYYIEH2lZh5Gpyv0a9-8WPkjQIvjxGeoRvKmGLQgRvxd6MyqBgDAheB5yzVHqY8EZzgw8L0vQhEgb1HpLANCpbSF7VcTxjqkJyBEsQNZCXW62K1w=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/icon-failure-20.png\" width=\"20\" height=\"20\" class=\"m_-3594805284658035001img-block CToWUd\"></td>\r\n                        <td valign=\"middle\" style=\"font-size:13px;font-weight:400;line-height:20px;color:#ff4743;font-family:Segoe UI,Helvetica,Arial,sans-serif;padding-top:0px;vertical-align:middle;text-transform:uppercase\">{API}</td>\r\n                \r\n                </tr>\r\n            </tbody></table>\r\n        \r\n                        </td>\r\n                      </tr>\r\n        \r\n                        \r\n                          <tr>\r\n                            <td class=\"m_-3594805284658035001title\" style=\"padding:0 0 24px 0;color:#212121;font-size:28px;font-weight:bold;letter-spacing:-0.04em;line-height:40px;word-break:break-word\">\r\n                             {TITLE}\r\n                            </td>\r\n                          </tr>\r\n                      \r\n        \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            <!-- <pre style=\"white-space:pre-wrap;display:inline;font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;padding:0px;margin:0px;font-size:14px;line-height:20px;color:#444444;word-break:break-word\">Ran for 25 seconds</pre> -->\r\n                       </td>\r\n                      </tr>\r\n                      \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            \r\n        \r\n        \r\n<!--         \r\n        <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                      \r\n                      <td align=\"center\" bgcolor=\"#007acc\" style=\"padding:8px 12px;border-radius:2px\">\r\n                        <a href=\"https://dev.azure.com/BroxelDev/web/build.aspx?pcguid=87cecc23-6053-4e3b-9823-cb915131eec4&amp;builduri=vstfs%3a%2f%2f%2fBuild%2fBuild%2f36516&amp;tracking_data=eyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%3d\" style=\"font-weight:500;font-size:14px;text-decoration:none;padding:0px;display:inline-block;color:#ffffff\" class=\"m_-3594805284658035001mobile-button m_-3594805284658035001btn-primary\" target=\"_blank\" data-saferedirecturl=\"https://www.google.com/url?q=https://dev.azure.com/BroxelDev/web/build.aspx?pcguid%3D87cecc23-6053-4e3b-9823-cb915131eec4%26builduri%3Dvstfs%253a%252f%252f%252fBuild%252fBuild%252f36516%26tracking_data%3DeyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%253d&amp;source=gmail&amp;ust=1601407055375000&amp;usg=AFQjCNFlAPKWnSTO1iFkjil1vsarMYhhsQ\">\r\n                          View results\r\n                        </a>\r\n                      </td>\r\n                      \r\n                      \r\n                    \r\n        \r\n        \r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table> -->\r\n        \r\n                        </td>\r\n                      </tr>\r\n                    </tbody></table>\r\n                  </td>\r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table>\r\n        \r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                </td>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background:#f8f8f8\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">            \r\n                        \r\n                            \r\n                            \r\n                                    <tbody>\r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Exceptions\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                {EXCEPTIONS}\r\n                            </td>\r\n                        </tr>\r\n\r\n                        \r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n        \r\n                        \r\n                        \r\n        \r\n        <tr>\r\n        <td style=\"padding:24px 24px 24px 24px\">\r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                </tr>\r\n                    <tr>\r\n                    </tr>\r\n                \r\n                    <tr>\r\n                    </tr>\r\n            </tbody></table>\r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                    \r\n                </td>   \r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n            </tr>\r\n         </tbody></table>\r\n        </div>";

        public string TemplateRepositoryFile { get; set; } = "<div class=\"m_-3594805284658035001container\" style=\"font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;color:#212121;font-size:14px;background:#f8f8f8\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n            <tbody><tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background-color:white;border-bottom:solid #eaeaea 1px\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n                        \r\n                        \r\n        <tbody><tr>\r\n            <td style=\"padding:20px 24px 25px 24px;background:white\">\r\n                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                    <tbody><tr>\r\n                        <td>\r\n                            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"m_-3594805284658035001logo\" width=\"100%\">\r\n                                <tbody><tr>\r\n                                    <td valign=\"middle\" style=\"vertical-align:middle\">\r\n                                        <!-- <img alt=\"Microsoft\" height=\"16\" src=\"https://ci5.googleusercontent.com/proxy/n5DO0ehZnx5Fu70IFup8danV4RPNKJRGGp6_zn__LMrXJyzwXwgq0OOl0IEtMtMPymeH-xAZ70DFXsZwTGpZGetuUghalnbFjvL5EBeJVaMw=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/v3/microsoft.png\" width=\"80\" class=\"CToWUd\"> -->\r\n                                    </td>\r\n                                        <td valign=\"middle\" style=\"word-wrap:none;vertical-align:middle;text-align:right\">\r\n                                            <span style=\"color:#666666\"><span class=\"il\">BackOffice</span></span> <span style=\"color:#0078d4;font-weight:bold\">Api\u00B4s</span>\r\n                                        </td>\r\n                                </tr>\r\n                            </tbody></table>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n            </td>\r\n        </tr>\r\n        \r\n                        \r\n                        \r\n        \r\n        \r\n        \r\n        \r\n        <tr>\r\n        <td style=\"padding:0px 24px\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"max-width:592px\" class=\"m_-3594805284658035001responsive-table\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                  <td>\r\n                    <table>\r\n                      <tbody><tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                          \r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle\">\r\n                <tbody><tr>\r\n                        \r\n                       <td style=\"padding-right:7px\" valign=\"top\"><img src=\"https://ci5.googleusercontent.com/proxy/bYYIEH2lZh5Gpyv0a9-8WPkjQIvjxGeoRvKmGLQgRvxd6MyqBgDAheB5yzVHqY8EZzgw8L0vQhEgb1HpLANCpbSF7VcTxjqkJyBEsQNZCXW62K1w=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/icon-failure-20.png\" width=\"20\" height=\"20\" class=\"m_-3594805284658035001img-block CToWUd\"></td>\r\n                        <td valign=\"middle\" style=\"font-size:13px;font-weight:400;line-height:20px;color:#ff4743;font-family:Segoe UI,Helvetica,Arial,sans-serif;padding-top:0px;vertical-align:middle;text-transform:uppercase\">{TYPEREPOSITORY}</td>\r\n                \r\n                </tr>\r\n            </tbody></table>\r\n        \r\n                        </td>\r\n                      </tr>\r\n        \r\n                        \r\n                          <tr>\r\n                            <td class=\"m_-3594805284658035001title\" style=\"padding:0 0 24px 0;color:#212121;font-size:28px;font-weight:bold;letter-spacing:-0.04em;line-height:40px;word-break:break-word\">\r\n                             {TITLE}\r\n                            </td>\r\n                          </tr>\r\n                      \r\n        \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            <!-- <pre style=\"white-space:pre-wrap;display:inline;font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;padding:0px;margin:0px;font-size:14px;line-height:20px;color:#444444;word-break:break-word\">Ran for 25 seconds</pre> -->\r\n                       </td>\r\n                      </tr>\r\n                      \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            \r\n        \r\n        \r\n<!--         \r\n        <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                      \r\n                      <td align=\"center\" bgcolor=\"#007acc\" style=\"padding:8px 12px;border-radius:2px\">\r\n                        <a href=\"https://dev.azure.com/BroxelDev/web/build.aspx?pcguid=87cecc23-6053-4e3b-9823-cb915131eec4&amp;builduri=vstfs%3a%2f%2f%2fBuild%2fBuild%2f36516&amp;tracking_data=eyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%3d\" style=\"font-weight:500;font-size:14px;text-decoration:none;padding:0px;display:inline-block;color:#ffffff\" class=\"m_-3594805284658035001mobile-button m_-3594805284658035001btn-primary\" target=\"_blank\" data-saferedirecturl=\"https://www.google.com/url?q=https://dev.azure.com/BroxelDev/web/build.aspx?pcguid%3D87cecc23-6053-4e3b-9823-cb915131eec4%26builduri%3Dvstfs%253a%252f%252f%252fBuild%252fBuild%252f36516%26tracking_data%3DeyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%253d&amp;source=gmail&amp;ust=1601407055375000&amp;usg=AFQjCNFlAPKWnSTO1iFkjil1vsarMYhhsQ\">\r\n                          View results\r\n                        </a>\r\n                      </td>\r\n                      \r\n                      \r\n                    \r\n        \r\n        \r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table> -->\r\n        \r\n                        </td>\r\n                      </tr>\r\n                    </tbody></table>\r\n                  </td>\r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table>\r\n        \r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                </td>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background:#f8f8f8\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">            \r\n                        \r\n                            \r\n                            \r\n                                    <tbody><tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Summary\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width:100%;border-collapse:collapse!important\">\r\n        <tbody><tr>            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">BasePath</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{BASEPATH}</td>\r\n        </tr>        <tr>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Connection</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{CONNECTION}</td>\r\n        </tr>       <tr>\r\n\t\t\t\t\t<td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Object Request</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{OBJECTREQUEST}</td>\r\n        </tr>         \t\t\r\n</tbody></table>\r\n        \r\n                            </td>\r\n                        </tr>\r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Exceptions\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                {EXCEPTIONS}\r\n                            </td>\r\n                        </tr>\r\n\r\n                        \r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n        \r\n                        \r\n                        \r\n        \r\n        <tr>\r\n        <td style=\"padding:24px 24px 24px 24px\">\r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                </tr>\r\n                    <tr>\r\n                    </tr>\r\n                \r\n                    <tr>\r\n                    </tr>\r\n            </tbody></table>\r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                    \r\n                </td>   \r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n            </tr>\r\n         </tbody></table>\r\n        </div>";

        public string TemplateFtp { get; set; } = "<div class=\"m_-3594805284658035001container\" style=\"font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;color:#212121;font-size:14px;background:#f8f8f8\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n            <tbody><tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background-color:white;border-bottom:solid #eaeaea 1px\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n                        \r\n                        \r\n        <tbody><tr>\r\n            <td style=\"padding:20px 24px 25px 24px;background:white\">\r\n                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                    <tbody><tr>\r\n                        <td>\r\n                            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"m_-3594805284658035001logo\" width=\"100%\">\r\n                                <tbody><tr>\r\n                                    <td valign=\"middle\" style=\"vertical-align:middle\">\r\n                                        <!-- <img alt=\"Microsoft\" height=\"16\" src=\"https://ci5.googleusercontent.com/proxy/n5DO0ehZnx5Fu70IFup8danV4RPNKJRGGp6_zn__LMrXJyzwXwgq0OOl0IEtMtMPymeH-xAZ70DFXsZwTGpZGetuUghalnbFjvL5EBeJVaMw=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/v3/microsoft.png\" width=\"80\" class=\"CToWUd\"> -->\r\n                                    </td>\r\n                                        <td valign=\"middle\" style=\"word-wrap:none;vertical-align:middle;text-align:right\">\r\n                                            <span style=\"color:#666666\"><span class=\"il\">BackOffice</span></span> <span style=\"color:#0078d4;font-weight:bold\">Api\u00B4s</span>\r\n                                        </td>\r\n                                </tr>\r\n                            </tbody></table>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n            </td>\r\n        </tr>\r\n        \r\n                        \r\n                        \r\n        \r\n        \r\n        \r\n        \r\n        <tr>\r\n        <td style=\"padding:0px 24px\">\r\n        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"max-width:592px\" class=\"m_-3594805284658035001responsive-table\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                  <td>\r\n                    <table>\r\n                      <tbody><tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                          \r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle\">\r\n                <tbody><tr>\r\n                        \r\n                        <td style=\"padding-right:7px\" valign=\"top\"><img src=\"https://ci5.googleusercontent.com/proxy/bYYIEH2lZh5Gpyv0a9-8WPkjQIvjxGeoRvKmGLQgRvxd6MyqBgDAheB5yzVHqY8EZzgw8L0vQhEgb1HpLANCpbSF7VcTxjqkJyBEsQNZCXW62K1w=s0-d-e1-ft#https://cdn.vsassets.io/content/notifications/icon-failure-20.png\" width=\"20\" height=\"20\" class=\"m_-3594805284658035001img-block CToWUd\"></td>\r\n                        <td valign=\"middle\" style=\"font-size:13px;font-weight:400;line-height:20px;color:#ff4743;font-family:Segoe UI,Helvetica,Arial,sans-serif;padding-top:0px;vertical-align:middle;text-transform:uppercase\">{PTF}</td>\r\n                \r\n                </tr>\r\n            </tbody></table>\r\n        \r\n                        </td>\r\n                      </tr>\r\n        \r\n                        \r\n                          <tr>\r\n                            <td class=\"m_-3594805284658035001title\" style=\"padding:0 0 24px 0;color:#212121;font-size:28px;font-weight:bold;letter-spacing:-0.04em;line-height:40px;word-break:break-word\">\r\n                             {TITLE}\r\n                            </td>\r\n                          </tr>\r\n                      \r\n        \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            <!-- <pre style=\"white-space:pre-wrap;display:inline;font-family:'Segoe UI','-apple-system','BlinkMacSystemFont','Roboto','Arial',sans-serif;padding:0px;margin:0px;font-size:14px;line-height:20px;color:#444444;word-break:break-word\">Ran for 25 seconds</pre> -->\r\n                       </td>\r\n                      </tr>\r\n                      \r\n        \r\n                      <tr>\r\n                        <td style=\"padding:0 0 24px 0\">\r\n                            \r\n        \r\n        \r\n<!--         \r\n        <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          <tbody><tr>\r\n            <td>\r\n              <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                <tbody><tr>\r\n                      \r\n                      <td align=\"center\" bgcolor=\"#007acc\" style=\"padding:8px 12px;border-radius:2px\">\r\n                        <a href=\"https://dev.azure.com/BroxelDev/web/build.aspx?pcguid=87cecc23-6053-4e3b-9823-cb915131eec4&amp;builduri=vstfs%3a%2f%2f%2fBuild%2fBuild%2f36516&amp;tracking_data=eyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%3d\" style=\"font-weight:500;font-size:14px;text-decoration:none;padding:0px;display:inline-block;color:#ffffff\" class=\"m_-3594805284658035001mobile-button m_-3594805284658035001btn-primary\" target=\"_blank\" data-saferedirecturl=\"https://www.google.com/url?q=https://dev.azure.com/BroxelDev/web/build.aspx?pcguid%3D87cecc23-6053-4e3b-9823-cb915131eec4%26builduri%3Dvstfs%253a%252f%252f%252fBuild%252fBuild%252f36516%26tracking_data%3DeyJTb3VyY2UiOiJFbWFpbCIsIlR5cGUiOiJOb3RpZmljYXRpb24iLCJTSUQiOiJtcy52c3MtYnVpbGQuYnVpbGQtcmVxdWVzdGVkLXBlcnNvbmFsLXN1YnNjcmlwdGlvbiIsIlNUeXBlIjoiQ09OIiwiUmVjaXAiOjEsIl94Y2kiOnsiTklEIjozMTQ4NzEzMSwiTVJlY2lwIjoibTA9MSAiLCJBY3QiOiI5YzJhZWY4MC1kYTYzLTRiY2QtYTkyZC01ZWZhOWE0NjMwMmQifSwiRWxlbWVudCI6Imhlcm8vY3RhIn0%253d&amp;source=gmail&amp;ust=1601407055375000&amp;usg=AFQjCNFlAPKWnSTO1iFkjil1vsarMYhhsQ\">\r\n                          View results\r\n                        </a>\r\n                      </td>\r\n                      \r\n                      \r\n                    \r\n        \r\n        \r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table> -->\r\n        \r\n                        </td>\r\n                      </tr>\r\n                    </tbody></table>\r\n                  </td>\r\n                </tr>\r\n              </tbody></table>\r\n            </td>\r\n          </tr>\r\n        </tbody></table>\r\n        \r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                </td>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background-color:white;border-bottom:solid #eaeaea 1px\"></td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n                <td class=\"m_-3594805284658035001content\" width=\"640\" style=\"padding:0px;max-width:640px;background:#f8f8f8\">\r\n                    \r\n                    \r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">            \r\n                        \r\n                            \r\n                            \r\n                                    <tbody><tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Summary\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width:100%;border-collapse:collapse!important\">\r\n        <tbody><tr>            <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">DirectoryName</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{DIRECTORYNAME}</td>\r\n        </tr>        <tr>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">FileName</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{FILENAME}</td>\r\n        </tr>         <tr>\r\n\t\t\t\t\t<td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">User</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{USER}</td>\r\n        </tr>         <tr>\r\n\t\t\t\t\t<td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Password</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{PASSWORD}</td>\r\n        </tr>\t\t<tr>\r\n\t\t\t\t\t<td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Host</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{HOST}</td>\r\n        </tr>\t\t<tr>\r\n\t\t\t\t\t<td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Port</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{PORT}</td>\r\n        </tr>\t\t<tr>\r\n\t\t\t\t\t<td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:nowrap;font-weight:600;min-width:130px\">Action</td>\r\n                    <td style=\"vertical-align:top;padding:10px 4px;border-bottom:solid #eaeaea 1px;text-align:left;white-space:normal;width:99%;word-break:break-word\">{ACTION}</td>\r\n        </tr>\r\n\t\t\r\n</tbody></table>\r\n        \r\n                            </td>\r\n                        </tr>\r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n            <table border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align:middle;background-color:white\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                    <td style=\"padding:16px 24px 24px 24px\">\r\n                    \r\n        \r\n        \r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                        <tbody><tr>\r\n                            <td style=\"font-size:21px;line-height:25px;font-weight:600;letter-spacing:-0.04em;padding:0px;width:100%\">\r\n                                    Exceptions\r\n                                                    </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td style=\"padding:12px 0px 0px 0px;line-height:20px;max-width:544px\">\r\n                                {EXCEPTIONS}\r\n                            </td>\r\n                        </tr>\r\n\r\n                        \r\n                    </tbody></table>\r\n        \r\n                    \r\n        \r\n                </td>\r\n            </tr>\r\n        </tbody></table>\r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n                            \r\n                            \r\n                            \r\n                                    <tr>\r\n                                        <td style=\"padding:24px 24px 8px 24px;max-width:592px\">\r\n                                                \r\n        \r\n        \r\n        \r\n        \r\n        \r\n                                        </td>\r\n                                    </tr>\r\n                            \r\n        \r\n                        \r\n                        \r\n        \r\n        <tr>\r\n        <td style=\"padding:24px 24px 24px 24px\">\r\n            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"m_-3594805284658035001responsive-table\">\r\n                <tbody><tr>\r\n                </tr>\r\n                    <tr>\r\n                    </tr>\r\n                \r\n                    <tr>\r\n                    </tr>\r\n            </tbody></table>\r\n        </td>\r\n        </tr>\r\n        \r\n                    </tbody></table>\r\n                    \r\n                </td>   \r\n                <td class=\"m_-3594805284658035001mobile-hide\" style=\"background:#f8f8f8\"></td>\r\n            </tr>\r\n         </tbody></table>\r\n        </div>";
    }
}
